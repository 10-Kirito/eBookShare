"use strict";(self["webpackChunkdb_peoject_bs"]=self["webpackChunkdb_peoject_bs"]||[]).push([[170,305],{4305:function(e,t,o){o.r(t),o.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticStyle:{width:"500px",margin:"50px auto auto"}},[t("el-form",{attrs:{"label-width":"80px",size:"small"}},[t("el-form-item",{attrs:{label:"书名"}},[t("el-input",{attrs:{type:"textarea",rows:"1",autocomplete:"off",placeholder:"请输入书籍名称"},model:{value:e.form.bookname,callback:function(t){e.$set(e.form,"bookname",t)},expression:"form.bookname"}})],1),t("el-form-item",{attrs:{label:"作者"}},[t("el-input",{attrs:{type:"textarea",rows:"1",autocomplete:"off",placeholder:"请输入作者"},model:{value:e.form.author,callback:function(t){e.$set(e.form,"author",t)},expression:"form.author"}})],1),t("el-form-item",{attrs:{label:"出版社"}},[t("el-input",{attrs:{type:"textarea",rows:"1",autocomplete:"off",placeholder:"请输入出版社"},model:{value:e.form.publisher,callback:function(t){e.$set(e.form,"publisher",t)},expression:"form.publisher"}})],1),t("el-form-item",{attrs:{label:"isbn"}},[t("el-input",{attrs:{type:"textarea",rows:"1",autocomplete:"off",placeholder:"请输入书籍isbn"},model:{value:e.form.isbn,callback:function(t){e.$set(e.form,"isbn",t)},expression:"form.isbn"}})],1),t("el-form-item",{attrs:{label:"简介"}},[t("el-input",{attrs:{type:"textarea",rows:"6",autocomplete:"off",placeholder:"请输入简介"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{attrs:{label:"分类"}},[t("el-input",{attrs:{type:"textarea",rows:"1",autocomplete:"off",placeholder:"请输入分类"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),t("el-upload",{ref:"uploadpic",staticClass:"avatar-uploader",staticStyle:{"text-align":"center"},attrs:{action:"http://124.71.166.37:9091/books/uploadpic","show-file-list":!1,"auto-upload":!1,"on-success":e.addBookInfo,"on-change":e.handlePictureCardPreview}},[e.form.avatarurl?t("img",{staticClass:"avatar",attrs:{src:e.form.avatarurl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),t("el-form-item",[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{type:"file",data:e.uploadData,name:"file",action:"http://124.71.166.37:9091/books/upload",limit:1,"auto-upload":!1,"on-change":e.loadJsonFromFile,"on-success":e.uploadPicFile,"on-error":e.uploadError,"before-upload":e.beforeUpload,"before-remove":e.beforeRemove},scopedSlots:e._u([{key:"trigger",fn:function(){return[t("el-button",{staticClass:"ml-5",staticStyle:{margin:"20px 60px auto"},attrs:{type:"primary"}},[e._v("选择")])]},proxy:!0},{key:"tip",fn:function(){},proxy:!0}])},[t("el-button",{staticClass:"ml-5",staticStyle:{"margin-bottom":"20px"},attrs:{type:"success"},on:{click:e.uploadBookFile}},[e._v(" 确定 ")])],1)],1)],1)],1)],1)},l=[],s={name:"Person",data(){return{form:{},file:"",uploadFiles:[],uploadData:{},dialogVisible:!1,dialogImageUrl:"",queryParams:"",user:localStorage.getItem("loguserinfo")?JSON.parse(localStorage.getItem("loguserinfo")):{}}},methods:{btKeyUp(){this.form.bookname=this.form.bookname.replace(/[^\w\u4E00-\u9FA5]/g,"")},handlePictureCardPreview(e){this.dialogVisible=!0,e.url||(e.url=URL.createObjectURL(e.raw)),this.dialogImageUrl=e.url,this.form.avatarurl=e.url},loadJsonFromFile(e,t){this.uploadFiles=t;var o=e.name.replace(/.+\./,"");const a=e.size/1024/1024<100;var l=-1===["pdf","epub"].indexOf(o.toLowerCase());return l?(this.$message({type:"warning",message:"只能上传 PDF  EPUB 文件"}),!1):a?void 0:(this.$message({type:"warning",message:"附件大小超限，文件不能超过 100M"}),!1)},beforeUpload(e){console.log("文件：",e);var t=e.name.replace(/.+\./,"");const o=e.size/1024/1024<100;var a=-1===["pdf","epub"].indexOf(t.toLowerCase());return a?(this.$message({type:"warning",message:"只能上传 PDF  EPUB 文件"}),!1):o?void 0:(this.$message({type:"warning",message:"附件大小超限，文件不能超过 100M"}),!1)},beforeRemove(e,t){var o=e.name.replace(/.+\./,""),a=e.size/1024/1024<100,l=-1===["pdf","epub"].indexOf(o.toLowerCase());if(l&&a)return this.$confirm(`确定移除 ${e.name}？`);var s=t.indexOf(e);return t.splice(s,1),!1},updatebookpic(e){console.log(e),this.$message.success(e.msg)},uploadError(){this.$message.error("文件上传失败")},uploadBookFile(){this.$refs.upload.submit()},uploadPicFile(e){console.log(e),this.$refs.uploadpic.submit()},addBookInfo(e){let t=this.uploadFiles[0];this.$message.error("获取信息："+t.name),console.log(t.name),console.log(this.form);var o=encodeURIComponent(t.name),a=encodeURIComponent(this.form.bookname),l=encodeURIComponent(this.form.author),s=encodeURIComponent(this.form.publisher),r=encodeURIComponent(this.form.isbn),i=encodeURIComponent(this.form.description),n=encodeURIComponent(this.form.category);this.request.get("/books/addbookinfo",{params:{filename:o,bookname:a,author:l,publisher:s,isbn:r,description:i,category:n}}).then((e=>{"200"===e.code?this.$message.success("上传成功"):this.$message.error("上传失败")}))},handleAvatarSuccess(e){this.form.avatarurl=e},picChange(e){e.url||(e.url=URL.createObjectURL(e.raw)),this.$message.error("图片预览url"+e.url),console.log(e),this.form.avatarurl=e.uid}}},r=s,i=o(1001),n=(0,i.Z)(r,a,l,!1,null,null,null),c=n.exports},2170:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{margin:"10px 0"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入用户名","suffix-icon":"el-icon-search"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t("el-input",{staticClass:"ml-5",staticStyle:{width:"200px"},attrs:{placeholder:"请输入电子邮箱","suffix-icon":"el-icon-message"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),t("el-input",{staticClass:"ml-5",staticStyle:{width:"200px"},attrs:{placeholder:"请输入电话号码","suffix-icon":"el-icon-message"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),t("el-button",{staticClass:"ml-5",attrs:{type:"primary"},on:{click:e.load}},[e._v("搜索")]),t("el-button",{attrs:{type:"warning"},on:{click:e.reset}},[e._v("重置")])],1),t("div",{staticStyle:{margin:"10px 0"}},[t("el-button",{staticClass:"ml-5",attrs:{type:"primary"},on:{click:e.handleEdit2}},[e._v("新增用户"),t("i",{staticClass:"el-icon-bottom"})]),t("el-button",{staticClass:"ml-5",attrs:{type:"primary"},on:{click:e.exp}},[e._v("导出"),t("i",{staticClass:"el-icon-top"})])],1),t("el-table",{attrs:{data:e.tableData,border:"",stripe:"","header-cell-class-name":"headerBg"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{prop:"username",label:"用户名",width:"120"}}),t("el-table-column",{attrs:{prop:"password",label:"密码",width:"150"}}),t("el-table-column",{attrs:{prop:"email",label:"电子邮箱"}}),t("el-table-column",{attrs:{prop:"phone",label:"电话号码"}}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handleEdit(o.row)}}},[e._v("编辑"),t("i",{staticClass:"el-icon-edit"})]),t("el-popconfirm",{staticClass:"ml-5",attrs:{"confirm-button-text":"确认","cancel-button-text":"取消",icon:e.InfoFilled,"icon-color":"#626AEF",title:"是否删除?"},on:{confirm:function(t){return e.del(o.row.id)},cancel:e.cancelEvent},scopedSlots:e._u([{key:"reference",fn:function(){return[t("el-button",{attrs:{type:"danger"}},[e._v("删除"),t("i",{staticClass:"el-icon-remove-outline"})])]},proxy:!0}],null,!0)})]}}])})],1),t("div",{staticStyle:{padding:"10px 0"}},[t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[2,5,10,20],"page-size":e.pageSize,small:e.small,disabled:e.disabled,background:e.background,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange},model:{value:e.pageSize,callback:function(t){e.pageSize=t},expression:"pageSize"}})],1),t("el-dialog",{attrs:{title:"书籍信息",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("span",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(" 确认 ")])],1)]},proxy:!0}])},[t("el-form",{attrs:{"label-width":"80px",size:"small"}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"密码"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{label:"电子邮箱"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"电话号码"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1)],1),t("el-dialog",{attrs:{title:"书籍信息",visible:e.UserFormVisible,width:"30%"},on:{"update:visible":function(t){e.UserFormVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("span",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.UserFormVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(" 确认 ")])],1)]},proxy:!0}])},[t("el-form",{attrs:{"label-width":"80px",size:"small"}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"密码"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{label:"电子邮箱"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"电话号码"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1)],1)],1)},l=[],s=(o(7658),o(4305)),r={name:"User",computed:{EBookUpload(){return s["default"]}},data(){return{tableData:[],total:0,pageNum:1,pageSize:10,id:"",username:"",email:"",phone:"",password:"",currentsize:"",dialogFormVisible:!1,UserFormVisible:!1,multipleSelection:[],form:{},headerBg:"headerBg"}},created(){this.load()},methods:{load(){this.request.get("/users/page",{params:{pageNum:this.pageNum,pageSize:this.pageSize,username:this.username,email:this.email,phone:this.phone}}).then((e=>{console.log(e),this.tableData=e.records,this.total=e.total}))},save(){this.request.post("/users/save",this.form).then((e=>{e?(this.$message.success("保存成功"),this.dialogFormVisible=!1,this.UserFormVisible=!1,this.load()):this.$message.error("保存失败")}))},handleEdit(e){this.form=e,this.dialogFormVisible=!0},handleEdit2(e){this.UserFormVisible=!0},handleAdd(){this.dialogFormVisible=!0,this.form={}},handleSelectionChange(e){console.log(e),this.multipleSelection=e},EBookup(){this.$router.push("/admins/ebookupload")},reset(){this.email="",this.username="",this.phone="",this.load()},handleSizeChange(e){this.pageSize=e,this.load()},handleCurrentChange(e){this.pageNum=e,this.load()},exp(){window.open("http://localhost:9090/users/export")},del(e){this.request.delete("/users/"+e).then((e=>{"200"===e.code?(this.$message.success("删除成功"),this.load()):this.$message.error("删除失败")}))},handleExcelImportSuccess(){this.$message.success("文件上传成功！"),this.load()}}},i=r,n=o(1001),c=(0,n.Z)(i,a,l,!1,null,null,null),m=c.exports}}]);
//# sourceMappingURL=170.50f31224.js.map