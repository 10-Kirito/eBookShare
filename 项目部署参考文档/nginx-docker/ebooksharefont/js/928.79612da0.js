"use strict";(self["webpackChunkfrontdesk"]=self["webpackChunkfrontdesk"]||[]).push([[928],{1928:function(t,e,s){s.r(e),s.d(e,{default:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("div",[e("el-main",{staticClass:"el-main"},[e("div",{staticStyle:{"margin-bottom":"10px","margin-top":"20px"}},[e("el-row",{staticStyle:{"margin-bottom":"30px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"input is-rounded",staticStyle:{width:"40%","font-size":"25px"},attrs:{type:"text",placeholder:"输入关键字搜索图书"},domProps:{value:t.searchQuery},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}}),e("button",{staticClass:"button is-success is-rounded",staticStyle:{"font-size":"26px","margin-left":"10px"},on:{click:t.searchBooks}},[t._v("查询")])])],1),e("div",{staticStyle:{margin:"0 100px"}},[e("div",[e("div",[e("div",{staticClass:"grid-content bg-purple-light"},[t._l(t.bookDetails,(function(s,a){return e("el-card",{key:a,staticClass:"box-card"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"book-cover",attrs:{span:6}},[e("el-image",{staticStyle:{cursor:"pointer",height:"160px","margin-left":"80px"},attrs:{src:s.coverimage,fit:"contain",lazy:""},on:{click:function(e){return t.pushDetail(a)}}})],1),e("el-col",{attrs:{span:15}},[e("el-row",{staticClass:"attriclass"},[e("el-col",{attrs:{span:23}},[e("h3",{staticStyle:{cursor:"pointer","text-decoration":"underline"},on:{click:function(e){return t.pushDetail(a)}}},[t._v(t._s(s.bookname))])]),e("el-col",{attrs:{span:1}},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:s.isCollected?"取消收藏":"收藏"}},[e("i",{class:s.collectBtnClass,staticStyle:{cursor:"pointer","font-size":"25px","margin-left":"18px","margin-top":"20px"},on:{click:function(e){return t.collectBtn(a,s)}}})])],1)],1),e("el-row",{staticClass:"attriclass"},[e("div",{staticClass:"grid-content book-publisher",attrs:{title:"出版社"}},[t._v(t._s(s.publisher))])]),e("el-row",{staticClass:"attriclass"},[e("span",{staticClass:"book-author",attrs:{title:"找到该作者的所有书籍"},on:{click:function(e){return t.redirectToAuthorBooks(s.author)}}},[t._v(t._s(s.author))])]),e("el-row",{staticStyle:{"margin-top":"40px","margin-right":"-70px"},attrs:{gutter:24}},[e("el-col",{attrs:{span:2}},[e("div",{staticStyle:{color:"#8C8C8C"}},[t._v("年:")])]),e("el-col",{attrs:{span:6}},[e("div",{staticStyle:{"margin-top":"2px"}},[t._v(t._s(s.releasetime))])]),e("el-col",{attrs:{span:4}},[e("div",{staticStyle:{color:"#8C8C8C"}},[t._v("文件：")])]),e("el-col",{attrs:{span:4}},[e("div",{staticStyle:{"margin-top":"2px"}},[t._v(t._s(s.type))])])],1)],1)],1)],1)})),e("el-pagination",{attrs:{"current-page":t.pageNum,"page-sizes":[2,5,10,20],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],2)])])])])],1)},o=[],i=(s(7658),s(1120)),r={name:"SearchResult",data(){return{pageTitle:"上海大学电子图书分享平台",bookDetails:[],searchQuery:"",total:0,pageNum:1,pageSize:10,user:localStorage.getItem("loguserinfo")?JSON.parse(localStorage.getItem("loguserinfo")):{id:0}}},created(){const t=this.$route.query.params;if(t)try{this.searchQuery=JSON.parse(t),console.log("数据是：",this.searchQuery)}catch(e){console.error("解析参数出错：",e)}else console.warn("未找到参数");this.searchBooks()},methods:{searchBooks(){this.request.get("/FrontBooks/search",{params:{bookinfo:this.searchQuery,userid:this.user.id,pageNum:this.pageNum,pageSize:this.pageSize}}).then((t=>{console.log(t.data),this.bookDetails=t.data,this.bookDetails.forEach((t=>{t.collectBtnClass="el-icon-star-off",-1==t.favorites?(t.isCollected=!0,t.collectBtnClass="el-icon-star-on"):t.isCollected=!1,-1==t.likes?t.islike=!0:t.islike=!1}))})),this.load()},redirectToAuthorBooks(t){this.$router.push({path:"/searchResult",query:{params:JSON.stringify(t)}}),location.reload()},load(){this.request.get("/",{params:{pageNum:this.pageNum,pageSize:this.pageSize,bookname:this.searchQuery}}).then((t=>{this.bookDetails=t.records,this.total=t.total,this.bookDetails.forEach((t=>{t.isCollected=!1,t.collectBtnClass="el-icon-star-off"}))}))},handleSizeChange(t){this.pageSize=t,this.load()},handleCurrentChange(t){this.pageNum=t,this.load()},collectBtn(t,e){0!=this.user.id?(this.bookDetails[t].isCollected=!this.bookDetails[t].isCollected,this.bookDetails[t].isCollected?(this.$message({message:"收藏成功",type:"success"}),this.bookDetails[t].collectBtnClass="el-icon-star-on",this.request.get("http://124.71.166.37:9091/relationship/favourbook",{params:{bookid:e.bookid,userid:this.user.id}}).then((t=>{console.log(t)})),console.log("收藏")):(this.$message({message:"取消成功",type:"success"}),this.bookDetails[t].collectBtnClass="el-icon-star-off",this.request.get("http://124.71.166.37:9091/relationship/favourbook",{params:{bookid:e.bookid,userid:this.user.id}}).then((t=>{console.log(t)})),console.log("取消收藏")),this.$forceUpdate()):this.$message.error("请先登录")},pushDetail(t){i.Z.push({path:"/bookdetails",query:{params:JSON.stringify(this.bookDetails[t])}})}}},l=r,c=s(3736),n=(0,c.Z)(l,a,o,!1,null,"8cdbac66",null),h=n.exports}}]);
//# sourceMappingURL=928.79612da0.js.map