"use strict";(self["webpackChunkfrontdesk"]=self["webpackChunkfrontdesk"]||[]).push([[629],{6629:function(e,s,t){t.r(s),t.d(s,{default:function(){return n}});var r=function(){var e=this,s=e._self._c;return s("div",{staticStyle:{"min-height":"6000px"},attrs:{align:"center"}},[s("el-card",{staticStyle:{width:"500px"}},[s("el-form",{attrs:{"label-width":"80px",size:"small"}},[s("el-upload",{staticClass:"avatar-uploader",staticStyle:{"text-align":"center"},attrs:{action:"http://61.171.68.199:9091/file/avartar/upload","show-file-list":!1,"on-success":e.handleAvatarSuccess,data:this.form}},[e.form.avatarurl?s("img",{staticClass:"avatar",attrs:{src:e.form.avatarurl}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),s("el-form-item",{attrs:{label:"账号"}},[s("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:e.form.username,callback:function(s){e.$set(e.form,"username",s)},expression:"form.username"}})],1),s("el-form-item",{attrs:{label:"邮箱"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(s){e.$set(e.form,"email",s)},expression:"form.email"}})],1),s("el-form-item",{attrs:{label:"电话"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(s){e.$set(e.form,"phone",s)},expression:"form.phone"}})],1),s("el-row",[s("el-button",{staticStyle:{width:"20%"},attrs:{type:"primary",size:"medium"},on:{click:e.openDialog}},[e._v("修改密码")]),s("el-button",{staticStyle:{width:"20%"},attrs:{type:"success",size:"medium"},on:{click:e.save}},[e._v("确认")])],1)],1)],1),s("el-dialog",{attrs:{title:"修改密码",visible:e.dialogFormVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(s){e.dialogFormVisible=s}}},[s("el-form",{ref:"checkForm",attrs:{"label-width":"80px",model:e.ruleForm,"status-icon":"",rules:e.rules}},[s("el-form-item",{attrs:{label:"新密码",prop:"pass"}},[s("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.pass,callback:function(s){e.$set(e.ruleForm,"pass",s)},expression:"ruleForm.pass"}})],1),s("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[s("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.checkPass,callback:function(s){e.$set(e.ruleForm,"checkPass",s)},expression:"ruleForm.checkPass"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.savePassword}},[e._v("保 存")])],1)],1)],1)},a=[],o=(t(7658),t(8082)),l={name:"Person",data(){var e=(e,s,t)=>{""===s?t(new Error("请输入密码")):(""!==this.ruleForm.checkPass&&this.$refs.checkForm.validateField("checkPass"),t())},s=(e,s,t)=>{""===s?t(new Error("请再次输入密码")):s!==this.ruleForm.pass?t(new Error("两次输入密码不一致!")):t()};return{ruleForm:{pass:"",checkPass:""},rules:{pass:[{validator:e,trigger:"blur"}],checkPass:[{validator:s,trigger:"blur"}]},dialogFormVisible:!1,form:{},user:localStorage.getItem("loguserinfo")?JSON.parse(localStorage.getItem("loguserinfo")):{}}},created(){this.getUser().then((e=>{console.log(e),this.form=e}))},methods:{openDialog(){this.dialogFormVisible=!0},encryptPassword(e){const s=(0,o.MD5)(e).toString();return s},savePassword(){this.$refs.checkForm.validate((e=>{if(!e)return console.log("error submit!!"),!1;this.form.password=this.ruleForm.pass,this.form.password=this.encryptPassword(this.form.password),this.request.post("/users/changepassword",this.form).then((e=>{e?(this.$message.success("保存成功"),this.dialogFormVisible=!1):this.$message.error("保存失败")}))}))},async getUser(){return(await this.request.get("/users/"+this.user.username)).data},save(){this.request.post("/users",this.form).then((e=>{e?(this.$message.success("保存成功"),this.$emit("refreshUser"),this.getUser().then((e=>{localStorage.setItem("loguserinfo",JSON.stringify(e))})),this.$router.push("/home")):this.$message.error("保存失败")}))},handleAvatarSuccess(e){this.form.avatarurl=e,this.$message.success("保存成功")}}},i=l,c=t(1001),u=(0,c.Z)(i,r,a,!1,null,null,null),n=u.exports}}]);
//# sourceMappingURL=629.58fab780.js.map